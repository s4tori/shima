############################################################################
# Documentation
############################################################################

name: ğŸ“š Doc
on:
    push:
        branches:
            - master
        paths:
            - "docs/**"

defaults:
    run:
        working-directory: docs

jobs:
    build:
        name: ğŸ“š Build and deploy documentation
        runs-on: ubuntu-latest
        permissions:
            contents: write

        steps:
            - name: ğŸ›ï¸ Checkout code
              uses: actions/checkout@v3

            - name: ğŸšš Setup PNPM
              uses: pnpm/action-setup@v2
              with:
                  version: 7

            - name: ğŸšš Setup Node
              uses: actions/setup-node@v3
              with:
                node-version: 16
                cache: pnpm
                cache-dependency-path: docs/pnpm-lock.yaml

            - name: ğŸ‘· Install dependencies
              run: pnpm install --frozen-lockfile

            - name: ğŸ—ï¸ Build project
              run: pnpm run build:prod

            - name: ğŸš€ Deploy documentation
              uses: JamesIves/github-pages-deploy-action@v4.3.3
              with:
                branch: gh-pages
                folder: docs/dist
                clean: true
                silent: true
